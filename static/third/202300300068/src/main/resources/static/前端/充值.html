<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>充值</title>
    <style>
        div{
            margin: auto;
            text-align: center;
            background-color: orange;
            width: 350px;
            height: 300px;
        }
        h1{
            background-color: red;
            color: wheat;
        }
    </style>
</head>
<body>
<div>
    <h1>充值</h1>
    请输入学号:<input type="text" placeholder="请输入学号" class="box1">
    <br>
    <br>
    请输入充值金额: <input type="text" placeholder="请输入充值金额" class="box2">
    <br>
    <br>
    <img src="./支付方式.jpg" alt="图片加载错误" style="height: 100px;">
    <br>
    <button onclick="save()">充值</button>
</div>
<script>
    function save(){
        let a = document.getElementsByClassName("box1")[0].value;
        let b = parseInt(document.getElementsByClassName("box2")[0].value);
        if(b <= 0){
            alert('充值金额必须大于0')
        }else{
            fetch('http://localhost:8080/getaccount',{
                method : 'POST',
                headers:{
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    num: a,
                })
            })
                .then(function (response){
                    return response.json()
                })
                .then(function (data) {
                    fetch('http://localhost:8080/updateaccount',{
                        method : 'POST',
                        headers:{
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            num: a,
                            balance: b + data.data.balance
                        })
                    })
                })
            window.location.href='http://localhost:8080/%E5%89%8D%E7%AB%AF/%E8%B4%AD%E4%B9%B0%E9%A1%B5%E9%9D%A2.html'
        }

    }
</script>
</body>
</html>